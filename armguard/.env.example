# ============================================================
# ArmGuard Environment Configuration
# ============================================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control!

# ============================================================
# Django Core Settings
# ============================================================

# Django Secret Key (CRITICAL: Generate new one for production!)
# Generate with: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
DJANGO_SECRET_KEY=your-secret-key-here-change-this-in-production

# Debug mode (True for development, False for production)
DJANGO_DEBUG=True

# Django Settings Module
# Use 'core.settings' for development, 'core.settings_production' for production
DJANGO_SETTINGS_MODULE=core.settings

# Allowed hosts (comma-separated, no spaces)
# IMPORTANT: Add your server's IP address for mobile/network access!
# For Raspberry Pi deployment, add your RPi's IP address
# Example: DJANGO_ALLOWED_HOSTS=yourdomain.com,192.168.1.100,127.0.0.1,localhost,armguard.rds
DJANGO_ALLOWED_HOSTS=127.0.0.1,localhost,armguard.rds

# CSRF Trusted Origins (for HTTPS, comma-separated)
# Example: CSRF_TRUSTED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CSRF_TRUSTED_ORIGINS=

# ============================================================
# Enhanced Security Configuration
# ============================================================

# Admin URL (Obfuscation - use random string in production)
# Default: superadmin
# Example: DJANGO_ADMIN_URL=secret-portal-x7k2m9p
DJANGO_ADMIN_URL=superadmin

# Password Requirements
PASSWORD_MIN_LENGTH=8
# Set to 12+ for production

# Enhanced Security Middleware
SECURITY_HEADERS_ENABLED=True
REQUEST_LOGGING_ENABLED=True
SINGLE_SESSION_ENFORCEMENT=True
RATE_LIMITING_ENABLED=True

# Admin System Configuration
ADMIN_RESTRICTION_SYSTEM_ENABLED=True
ADMIN_SESSION_TIMEOUT=3600

# API Security Settings
API_RATE_LIMIT=100
API_BURST_LIMIT=20

# Device Authorization
DEVICE_AUTHORIZATION_ENABLED=True
DEVICE_ALLOW_ALL=False

# File Upload Limits (in bytes)
FILE_UPLOAD_MAX_MEMORY_SIZE=5242880
# 5MB
DATA_UPLOAD_MAX_MEMORY_SIZE=5242880
# 5MB

# Enhanced SSL/HTTPS Settings (Enable for production)
SECURE_SSL_REDIRECT=False  
# Set to True in production
SESSION_COOKIE_SECURE=False  
# Set to True in production
CSRF_COOKIE_SECURE=False  
# Set to True in production
SECURE_HSTS_SECONDS=0  
# Set to 31536000 (1 year) in production
SESSION_COOKIE_SAMESITE=Lax
CSRF_COOKIE_SAMESITE=Lax

# Rate Limiting
RATELIMIT_ENABLE=True
RATELIMIT_REQUESTS_PER_MINUTE=60  
# Requests per IP per minute

# Django Axes (Failed Login Protection)
AXES_ENABLED=True
AXES_FAILURE_LIMIT=5  
# Lock account after X failed attempts
AXES_COOLOFF_TIME=1  
# Lockout duration in hours

# Enhanced Session Security
SESSION_COOKIE_AGE=3600  
# Session timeout in seconds (1 hour)
SESSION_EXPIRE_AT_BROWSER_CLOSE=True

# ============================================================
# Enhanced Database Configuration
# ============================================================

# Database Engine Selection
# Use 'django.db.backends.postgresql' for production (recommended)
# Use 'django.db.backends.sqlite3' for development (automatic fallback)
DB_ENGINE=django.db.backends.postgresql

# PostgreSQL Settings (Production Database)
DB_NAME=armguard_db
DB_USER=armguard_user
DB_PASSWORD=your-strong-database-password-here
DB_HOST=localhost
DB_PORT=5432

# Database Connection Security
DB_SSL_MODE=prefer
# Options: disable, allow, prefer, require, verify-ca, verify-full

# Database Connection Pooling
DB_CONN_MAX_AGE=300
# Connection lifetime in seconds

# SQLite Fallback (Development)
# If DB_PASSWORD is empty, system will automatically use SQLite

# ============================================================
# File Storage Paths  !! READ BEFORE EDITING !!
# ============================================================
#
# MEDIA_ROOT and STATIC_ROOT are computed automatically by settings.py:
#
#   MEDIA_ROOT  = BASE_DIR / 'core' / 'media'
#                 → /home/rds/ARMGUARD_RDS_v.2/armguard/core/media/
#   STATIC_ROOT = BASE_DIR / 'staticfiles'
#                 → /home/rds/ARMGUARD_RDS_v.2/armguard/staticfiles/
#
# You do NOT need to set these for a standard deployment.
# Setting them to a WRONG value (e.g. the repo root instead of core/media)
# is the #1 cause of "images not found" / "Missing" badges in the Print Manager.
#
# Only un-comment and set these if you are deliberately moving storage to a
# different location (separate disk, NFS mount, etc.).
#
# MEDIA_ROOT=/home/rds/ARMGUARD_RDS_v.2/armguard/core/media
# STATIC_ROOT=/home/rds/ARMGUARD_RDS_v.2/armguard/staticfiles

# ============================================================
# Logging Configuration
# ============================================================

# Log file paths (create directories first: mkdir logs)
SECURITY_LOG_PATH=logs/security.log
ERROR_LOG_PATH=logs/errors.log
DJANGO_LOG_PATH=logs/django.log

# ============================================================
# Email Configuration (Optional)
# ============================================================

# Email Backend
EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend  # Use smtp.EmailBackend for production

# SMTP Settings (for production)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@example.com
EMAIL_HOST_PASSWORD=your-email-app-password

# Email Addresses
DEFAULT_FROM_EMAIL=noreply@armguard.local
SERVER_EMAIL=noreply@armguard.local
ADMIN_NAME=Admin
ADMIN_EMAIL=admin@example.com

# ============================================================
# Admin Customization (Optional)
# ============================================================

ADMIN_SITE_HEADER=ArmGuard Administration
ADMIN_SITE_TITLE=ArmGuard Admin
ADMIN_INDEX_TITLE=ArmGuard Dashboard

# ============================================================
# Advanced Security (Optional)
# ============================================================

# IP Whitelist for Admin Access (comma-separated, leave empty to disable)
# Example: ADMIN_ALLOWED_IPS=192.168.1.100,10.0.0.50
ADMIN_ALLOWED_IPS=

# ============================================================
# VPN Integration Settings (WireGuard)
# ============================================================

# Enable/disable VPN integration
WIREGUARD_ENABLED=False

# WireGuard interface name
WIREGUARD_INTERFACE=wg0

# VPN network subnet
WIREGUARD_NETWORK=10.0.0.0/24

# WireGuard server port
WIREGUARD_PORT=51820

# VPN Email Alerts
VPN_EMAIL_ALERTS_ENABLED=False
VPN_ALERT_EMAILS=admin@armguard.local

# Maximum concurrent VPN connections
VPN_MAX_CONCURRENT_CONNECTIONS=50

# ============================================================
# Notes
# ============================================================
# 1. Always generate a new SECRET_KEY for production
# 2. Set DEBUG=False in production
# 3. Use PostgreSQL instead of SQLite for production
# 4. Enable all SSL/HTTPS settings when using HTTPS
# 5. Create 'logs' directory: mkdir logs
# 6. Protect .env file: chmod 600 .env
# 7. Do NOT add MEDIA_ROOT to this file unless intentionally overriding
#    the automatically-derived path.  An incorrect MEDIA_ROOT causes
#    the Print Manager (personnel ID cards) to show all entries as "Missing".
#    To verify what MEDIA_ROOT the running server sees, visit:
#      https://<server-ip>/print/id-cards/diagnostics/  (superuser only)
